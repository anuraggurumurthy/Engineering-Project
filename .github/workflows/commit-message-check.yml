name: Commit Message Check

on:
  push:
    branches:
      - master

jobs:
  validate-commit-message:
    runs-on: ubuntu-latest

    steps:
      - name: Checkout
        uses: actions/checkout@v4
        with:
          fetch-depth: 2

      - name: Validate commit message
        run: |
          COMMIT_MSG=$(git log -1 --pretty=%s)

          echo "Commit message: $COMMIT_MSG"

          if echo "$COMMIT_MSG" | grep -Eq '^(feat|fix|release|docs): .+'; then
            echo "✅ Commit message is valid"
          else
            echo "❌ Invalid commit message!"
            echo "Allowed formats:"
            echo "  feat: message"
            echo "  fix: message"
            echo "  release: x.y.z"
            echo "  docs: message"
            exit 1
          fi
